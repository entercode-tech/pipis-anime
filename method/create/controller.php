<?php

use Illuminate\Support\Facades\Http;

function controller($param)
{
    global $home_path;
    if (!isset($param[0])) {
        echo "\x5c\x65\x5b\x33\x31\x6d\x6b\x65\x74\x69\x6b\x20\x6e\x61\x6d\x61\x20\x63\x6f\x6e\x74\x72\x6f\x6c\x6c\x65\x72\x6e\x79\x61\x5c\x6e\x20\x5c\x65\x5b\x30\x6d";
        die;
    }
    if (!isset($param[1])) {
        echo "\x5c\x65\x5b\x33\x31\x6d\x6b\x65\x74\x69\x6b\x20\x6e\x61\x6d\x61\x20\x66\x69\x6c\x65\x20\x6d\x69\x67\x72\x61\x73\x69\x6e\x79\x61\x5c\x6e\x20\x5c\x65\x5b\x30\x6d";
        die;
    }
    try {
        $path = "$home_path/app/Http/Controllers/";
        $target_file = $path . $param[0] . "\x2e\x70\x68\x70";

        $migrasi = $home_path . "\x2f\x64\x61\x74\x61\x62\x61\x73\x65\x2f\x6d\x69\x67\x72\x61\x74\x69\x6f\x6e\x73\x2f" . $param[1];
        if (!file_exists($migrasi)) {
            echo "\e[31mfilenya ngga ada kak -> $migrasi\n \e[0m";
            die;
        }
        $data["\x63\x6f\x6e\x74\x72\x6f\x6c\x6c\x65\x72\x5f\x6e\x61\x6d\x65"] = $param[0];
        $code = file_get_contents($migrasi);
        $pattern = "\x2f\x70\x75\x62\x6c\x69\x63\x5c\x73\x2b\x66\x75\x6e\x63\x74\x69\x6f\x6e\x5c\x73\x2b\x75\x70\x5c\x28\x5c\x29\x3a\x5b\x5c\x73\x5c\x53\x5d\x2a\x3f\x5c\x7d\x2f";

        preg_match_all($pattern, $code, $matches);

        if (empty($matches)) {
            echo "\x5c\x65\x5b\x33\x31\x6d\x73\x65\x70\x65\x72\x74\x69\x6e\x79\x61\x20\x61\x64\x61\x20\x79\x61\x6e\x67\x20\x73\x61\x6c\x61\x68\x20\x64\x65\x6e\x67\x61\x6e\x20\x66\x69\x6c\x65\x20\x6d\x69\x67\x72\x61\x73\x69\x6e\x79\x61\x2e\x5c\x6e\x20\x5c\x65\x5b\x30\x6d";
            die;
        }
        $data["\x6d\x69\x67\x72\x61\x74\x69\x6f\x6e\x5f\x63\x6f\x64\x65"] = $matches[0][0];

        put_result($target_file, $data, "\x2f\x6c\x61\x72\x61\x76\x65\x6c\x2d\x67\x65\x6e\x65\x72\x61\x74\x6f\x72\x2f\x63\x72\x65\x61\x74\x65\x2d\x63\x6f\x6e\x74\x72\x6f\x6c\x6c\x65\x72");
        echo "\e[32mwaah berhasil ! filenya ada disini kak -> $target_file\n \e[0m";
    } catch (\Throwable $th) {
        throw $th;
    }
}
